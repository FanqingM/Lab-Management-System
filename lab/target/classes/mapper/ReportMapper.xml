<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.se.mapper.ReportMapper">
  <resultMap id="BaseResultMap" type="com.se.entity.Report">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Oct 27 22:15:26 CST 2021.
    -->
    <constructor>
      <idArg column="STUDENT_ID" javaType="java.lang.String" jdbcType="VARCHAR" />
      <idArg column="COURSE_ID" javaType="java.lang.String" jdbcType="VARCHAR" />
      <idArg column="SECTION_ID" javaType="java.lang.String" jdbcType="VARCHAR" />
      <idArg column="LAB_ID" javaType="java.lang.String" jdbcType="VARCHAR" />
      <arg column="URL" javaType="java.lang.String" jdbcType="VARCHAR" />
      <arg column="GRADES" javaType="java.lang.Integer" jdbcType="INTEGER" />
      <arg column="PURPOSE" javaType="java.lang.String" jdbcType="VARCHAR" />
      <arg column="PROGRESS" javaType="java.lang.String" jdbcType="VARCHAR" />
      <arg column="PRINCIPLE" javaType="java.lang.String" jdbcType="VARCHAR" />
    </constructor>
  </resultMap>
  <resultMap id="FinishedReportDTOMap" type="com.se.dto.FinishedReportDTO">
    <result property="labId" column="LAB_ID"/>
    <result property="labName" column="NAME"/>
    <result property="grades" column="GRADES"/>
    <result property="courseName" column="COURSENAME"/>
    <result property="endTime" column="END_TIME"/>
    <result property="courseId" column="COURSE_ID"/>
    <result property="sectionId" column="SECTION_ID"/>
  </resultMap>
  <sql id="Base_Column_List">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Oct 27 22:15:26 CST 2021.
    -->
    STUDENT_ID, COURSE_ID, SECTION_ID, LAB_ID, URL, GRADES, PURPOSE, PROGRESS, PRINCIPLE
  </sql>
  <select id="selectByPrimaryKey" parameterType="com.se.entity.ReportKey" resultMap="BaseResultMap">
    select 
    <include refid="Base_Column_List" />
    from REPORT
    where STUDENT_ID = #{studentId,jdbcType=VARCHAR}
      and COURSE_ID = #{courseId,jdbcType=VARCHAR}
      and SECTION_ID = #{sectionId,jdbcType=VARCHAR}
      and LAB_ID = #{labId,jdbcType=VARCHAR}
  </select>

  <select id="selectFinishedReports" parameterType="com.se.entity.ReportKey" resultMap="FinishedReportDTOMap">
    select distinct REPORT.LAB_ID,LAB.NAME,REPORT.GRADES,COURSE.COURSENAME,LAB_INSTANCE.END_TIME,SECTION.COURSE_ID,SECTION.SECTION_ID
    from REPORT,LAB,LAB_INSTANCE,COURSE,SECTION
    where STUDENT_ID = #{studentId,jdbcType=VARCHAR} and LAB.LAB_ID = REPORT.LAB_ID and LAB.COURSE_ID = REPORT.COURSE_ID and COURSE.ID = LAB.COURSE_ID and LAB.COURSE_ID = LAB_INSTANCE.COURSE_ID and LAB.LAB_ID = LAB_INSTANCE.LAB_ID and SECTION.COURSE_ID = LAB_INSTANCE.COURSE_ID and SECTION.SECTION_ID = LAB_INSTANCE.SECTION_ID
  </select>

  <select id="selectReport" parameterType="com.se.entity.ReportKey" resultMap="BaseResultMap">
<!--    select-->
<!--    <include refid="Base_Column_List" />-->
<!--    from REPORT-->
<!--    where STUDENT_ID = #{studentId,jdbcType=VARCHAR}-->
    select
    REPORT.STUDENT_ID,REPORT.COURSE_ID,REPORT.SECTION_ID,REPORT.LAB_ID,REPORT.URL,REPORT.GRADES,REPORT.PURPOSE,REPORT.PROGRESS,REPORT.PRINCIPLE
    from REPORT
    where STUDENT_ID = #{studentId,jdbcType=VARCHAR}
  </select>

  <delete id="deleteByPrimaryKey" parameterType="com.se.entity.ReportKey">
    delete from REPORT
    where STUDENT_ID = #{studentId,jdbcType=VARCHAR}
      and COURSE_ID = #{courseId,jdbcType=VARCHAR}
      and SECTION_ID = #{sectionId,jdbcType=VARCHAR}
      and LAB_ID = #{labId,jdbcType=VARCHAR}
  </delete>
  <insert id="insert" parameterType="com.se.entity.Report">
    insert into REPORT (STUDENT_ID, COURSE_ID, SECTION_ID, 
      LAB_ID, URL, GRADES, PURPOSE, PROGRESS, PRINCIPLE)
    values (#{studentId,jdbcType=VARCHAR}, #{courseId,jdbcType=VARCHAR}, #{sectionId,jdbcType=VARCHAR}, 
      #{labId,jdbcType=VARCHAR}, #{url,jdbcType=VARCHAR}, #{grades,jdbcType=INTEGER}, #{purpose,jdbcType=VARCHAR}, #{progress,jdbcType=VARCHAR}, #{principle,jdbcType=VARCHAR},)
  </insert>
<!--  <insert id="insertSelective" parameterType="com.se.entity.Report">-->
<!--    &lt;!&ndash;-->
<!--      WARNING - @mbg.generated-->
<!--      This element is automatically generated by MyBatis Generator, do not modify.-->
<!--      This element was generated on Wed Oct 27 22:15:26 CST 2021.-->
<!--    &ndash;&gt;-->
<!--    insert into REPORT-->
<!--    <trim prefix="(" suffix=")" suffixOverrides=",">-->
<!--      <if test="studentId != null">-->
<!--        STUDENT_ID,-->
<!--      </if>-->
<!--      <if test="courseId != null">-->
<!--        COURSE_ID,-->
<!--      </if>-->
<!--      <if test="sectionId != null">-->
<!--        SECTION_ID,-->
<!--      </if>-->
<!--      <if test="labId != null">-->
<!--        LAB_ID,-->
<!--      </if>-->
<!--      <if test="url != null">-->
<!--        URL,-->
<!--      </if>-->
<!--      <if test="grades != null">-->
<!--        GRADES,-->
<!--      </if>-->
<!--    </trim>-->
<!--    <trim prefix="values (" suffix=")" suffixOverrides=",">-->
<!--      <if test="studentId != null">-->
<!--        #{studentId,jdbcType=VARCHAR},-->
<!--      </if>-->
<!--      <if test="courseId != null">-->
<!--        #{courseId,jdbcType=VARCHAR},-->
<!--      </if>-->
<!--      <if test="sectionId != null">-->
<!--        #{sectionId,jdbcType=VARCHAR},-->
<!--      </if>-->
<!--      <if test="labId != null">-->
<!--        #{labId,jdbcType=VARCHAR},-->
<!--      </if>-->
<!--      <if test="url != null">-->
<!--        #{url,jdbcType=VARCHAR},-->
<!--      </if>-->
<!--      <if test="grades != null">-->
<!--        #{grades,jdbcType=INTEGER},-->
<!--      </if>-->
<!--    </trim>-->
<!--  </insert>-->
<!--  <update id="updateByPrimaryKeySelective" parameterType="com.se.entity.Report">-->
<!--    &lt;!&ndash;-->
<!--      WARNING - @mbg.generated-->
<!--      This element is automatically generated by MyBatis Generator, do not modify.-->
<!--      This element was generated on Wed Oct 27 22:15:26 CST 2021.-->
<!--    &ndash;&gt;-->
<!--    update REPORT-->
<!--    <set>-->
<!--      <if test="url != null">-->
<!--        URL = #{url,jdbcType=VARCHAR},-->
<!--      </if>-->
<!--      <if test="grades != null">-->
<!--        GRADES = #{grades,jdbcType=INTEGER},-->
<!--      </if>-->
<!--    </set>-->
<!--    where STUDENT_ID = #{studentId,jdbcType=VARCHAR}-->
<!--      and COURSE_ID = #{courseId,jdbcType=VARCHAR}-->
<!--      and SECTION_ID = #{sectionId,jdbcType=VARCHAR}-->
<!--      and LAB_ID = #{labId,jdbcType=VARCHAR}-->
<!--  </update>-->
  <update id="updateByPrimaryKey" parameterType="com.se.entity.Report">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Oct 27 22:15:26 CST 2021.
    -->
    update REPORT
    set URL = #{url,jdbcType=VARCHAR},
      GRADES = #{grades,jdbcType=INTEGER},
      PURPOSE = #{purpose,jdbcType=VARCHAR},
      PROGRESS = #{progress,jdbcType=VARCHAR},
      PRINCIPLE = #{principle,jdbcType=VARCHAR}
    where STUDENT_ID = #{studentId,jdbcType=VARCHAR}
      and COURSE_ID = #{courseId,jdbcType=VARCHAR}
      and SECTION_ID = #{sectionId,jdbcType=VARCHAR}
      and LAB_ID = #{labId,jdbcType=VARCHAR}
  </update>
</mapper>