(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-26775f94"],{"00b4":function(t,e,a){"use strict";a("ac1f");var s=a("23e7"),l=a("da84"),n=a("c65b"),r=a("e330"),o=a("1626"),i=a("861d"),c=function(){var t=!1,e=/[ac]/;return e.exec=function(){return t=!0,/./.exec.apply(this,arguments)},!0===e.test("abc")&&t}(),u=l.Error,h=r(/./.test);s({target:"RegExp",proto:!0,forced:!c},{test:function(t){var e=this.exec;if(!o(e))return h(this,t);var a=n(e,this,t);if(null!==a&&!i(a))throw new u("RegExp exec method returned something other than an Object or null");return!!a}})},"0ffe":function(t,e,a){"use strict";a("c7b5")},b0c0:function(t,e,a){var s=a("83ab"),l=a("5e77").EXISTS,n=a("e330"),r=a("9bf2").f,o=Function.prototype,i=n(o.toString),c=/^\s*function ([^ (]*)/,u=n(c.exec),h="name";s&&!l&&r(o,h,{configurable:!0,get:function(){try{return u(c,i(this))[1]}catch(t){return""}}})},c7b5:function(t,e,a){},f1e6:function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticStyle:{height:"100%"}},[a("el-card",{staticStyle:{height:"100%"}},[a("div",{staticStyle:{"font-size":"18px",height:"30px"},attrs:{slot:"header"},slot:"header"},[a("span",[a("b",[t._v("导入用户列表")])])]),a("el-row",{staticStyle:{height:"calc(100% - 150px)",padding:"10px"}},[a("el-col",{attrs:{span:10}},[a("el-upload",{staticStyle:{width:"100%",height:"100%",margin:"50px"},attrs:{drag:"",action:"https://jsonplaceholder.typicode.com/posts/",accept:".xlsx","on-change":t.upload,limit:1,"on-exceed":t.handleExceed}},[a("i",{staticClass:"el-icon-upload"}),a("div",{staticClass:"el-upload__text"},[t._v(" 将文件拖到此处，或"),a("em",[t._v("点击上传")])]),a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[t._v(" 只能上传xlsx文件，且不超过500kb ")])]),a("el-row",{staticStyle:{width:"100%",height:"100px"}},[a("el-col",{attrs:{span:3,offset:8}},[a("el-button",{attrs:{type:"primary"},on:{click:t.submit}},[t._v("提交")])],1),a("el-col",{attrs:{span:3,offset:2}},[a("router-link",{attrs:{to:"/admin/user-management"}},[a("el-button",[t._v("取消")])],1)],1)],1)],1),a("el-col",{attrs:{span:10}},[t.userlist.length>0?a("el-table",{staticStyle:{width:"100%",height:"100%",margin:"50px",overflow:"auto"},attrs:{data:t.userlist,stripe:"","header-row-style":{height:"20px"},"cell-style":{padding:"5px"}}},[a("el-table-column",{attrs:{label:"学号",prop:"id"}}),a("el-table-column",{attrs:{label:"姓名",prop:"name"}}),a("el-table-column",{attrs:{label:"学院",prop:"schoolName"}}),a("el-table-column",{attrs:{label:"班级",prop:"classnum"}}),a("el-table-column",{attrs:{label:"邮箱",prop:"email"}})],1):t._e()],1)],1)],1)],1)},l=[],n=(a("ac1f"),a("00b4"),a("b0c0"),a("1146")),r=a.n(n),o=a("435a"),i={data:function(){return{userlist:[]}},methods:{handleExceed:function(){this.$message({type:"warning",message:"超出最大上传文件数量的限制！"})},upload:function(t,e){console.log("file",t),console.log("fileList",e);var a={0:t.raw};this.readExcel1(a)},readExcel1:function(t){var e=this;if(console.log(t),t.length<=0)return!1;if(!/\.(xls|xlsx)$/.test(t[0].name.toLowerCase()))return this.$Message.error("上传格式不正确，请上传xls或者xlsx格式"),!1;var a=new FileReader;a.onload=function(t){try{var a=t.target.result,s=r.a.read(a,{type:"binary"}),l=s.SheetNames[0],n=r.a.utils.sheet_to_json(s.Sheets[l]);console.log("ws",n),e.userlist=[];for(var o=0;o<n.length;++o)e.userlist.push({id:String(n[o].id),email:n[o].email,name:n[o].name,classnum:String(n[o].class),schoolName:n[o].school});console.log("user",e.userlist),e.$refs.upload.value=""}catch(i){return!1}},a.readAsBinaryString(t[0])},submit:function(){var t=this;Object(o["G"])(this.userlist).then((function(){t.$message("上传成功"),t.$router.go(-1)})).catch((function(e){console.log(e),t.$message("上传失败")}))}}},c=i,u=(a("0ffe"),a("2877")),h=Object(u["a"])(c,s,l,!1,null,"1b591cee",null);e["default"]=h.exports}}]);
//# sourceMappingURL=chunk-26775f94.f32b12b2.js.map